package kr.or.ddit.service.impl;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
import org.springframework.stereotype.Service;

import kr.or.ddit.mapper.UsersMapper;
import kr.or.ddit.service.UserService;
import kr.or.ddit.vo.UsersVO;

@Service
public class UserServiceImpl implements UserService {

	@Autowired
	UsersMapper usersMapper;
	
	@Autowired
	BCryptPasswordEncoder bCryptPasswordEncoder;
	
	//email과 password를 입력받아 회원 가입 처리(id는 기본키로써 자동생성)
	@Override
	public int save(UsersVO usersVO) {
		//암호화(encrypt) 처리
		String password = usersVO.getPassword();
		password = this.bCryptPasswordEncoder.encode(password);
		//패스워드를 저장 시 시큐리티를 설정하며 패스워드 인코딩용으로 등록한 빈을
		//	사용해서 암호화한 후에 저장하자
		usersVO.setPassword(password);
		
		return this.usersMapper.save(usersVO);
	}

}
